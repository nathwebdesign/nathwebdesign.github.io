(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[954],{4954:function(r,e,t){"use strict";t.r(e),t.d(e,{default:function(){return o}});var n=t(7437),c=t(2265),a=t(7691),u=t.n(a);function o(r){let{depart:e,arrivee:t,departCoords:a,arriveeCoords:o,poles:i}=r,l=(0,c.useRef)(null),s=(0,c.useRef)(null),d=(0,c.useRef)([]),f=(0,c.useRef)(null),p=(0,c.useRef)(!1);return(0,c.useEffect)(()=>{if(!p.current&&f.current)try{l.current=u().map(f.current,{center:[46.603354,1.888334],zoom:6,zoomControl:!0,attributionControl:!0}),u().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors",maxZoom:19,minZoom:3}).addTo(l.current),p.current=!0}catch(r){console.error("[Map] Erreur initialisation carte:",r)}return()=>{l.current&&p.current&&(l.current.remove(),l.current=null,p.current=!1)}},[]),(0,c.useEffect)(()=>{if(!l.current)return;s.current&&(l.current.removeLayer(s.current),s.current=null),d.current.forEach(r=>{l.current.removeLayer(r)}),d.current=[];let r=(r,e)=>u().divIcon({html:'<div style="background-color: '.concat(r,'; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">').concat(e,"</div>"),className:"",iconSize:[30,30],iconAnchor:[15,15]}),n=[];if(a&&Array.isArray(a)&&2===a.length)try{let t=u().marker(a,{icon:r("#0f172a","D")}).addTo(l.current);e&&t.bindPopup("D\xe9part: ".concat(e)),d.current.push(t),n.push(a)}catch(r){console.error("[Map] Erreur cr\xe9ation marker d\xe9part:",r)}if(o&&Array.isArray(o)&&2===o.length)try{let e=u().marker(o,{icon:r("#ef4444","A")}).addTo(l.current);t&&e.bindPopup("Arriv\xe9e: ".concat(t)),d.current.push(e),n.push(o)}catch(r){console.error("[Map] Erreur cr\xe9ation marker arriv\xe9e:",r)}if(a&&o&&Array.isArray(a)&&Array.isArray(o)&&2===a.length&&2===o.length)try{let r=[a,o];s.current=u().polyline(r,{color:"#0f172a",weight:4,opacity:.7,dashArray:"10, 10"}).addTo(l.current)}catch(r){console.error("[Map] Erreur lors du trac\xe9 de la route:",r)}n.length>0&&l.current?(l.current.invalidateSize(),requestAnimationFrame(()=>{if(l.current)try{if(1===n.length)l.current.setView(n[0],12,{animate:!0,duration:.5});else{let r=u().latLngBounds(n);l.current.fitBounds(r,{padding:[50,50],maxZoom:12,animate:!0,duration:.5})}}catch(r){console.error("[Map] Erreur ajustement vue:",r),l.current&&l.current.setView([46.603354,1.888334],6)}})):l.current&&requestAnimationFrame(()=>{if(l.current)try{l.current.invalidateSize(),l.current.setView([46.603354,1.888334],6,{animate:!0,duration:.5})}catch(r){console.error("[Map] Erreur setView France:",r)}})},[e,t,a,o]),(0,n.jsx)("div",{ref:f,className:"w-full h-full"})}t(966)},966:function(){}}]);