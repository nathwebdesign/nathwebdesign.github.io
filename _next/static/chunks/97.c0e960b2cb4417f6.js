"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[97],{8097:function(e,r,t){t.r(r),t.d(r,{default:function(){return o}});var s=t(7437),a=t(2265);function o(e){let{value:r,onChange:t,placeholder:o,required:n=!1}=e,[l,u]=(0,a.useState)([]),[c,i]=(0,a.useState)(!1),[d,p]=(0,a.useState)(-1),f=(0,a.useRef)(null),g=(0,a.useRef)(null),m=(0,a.useCallback)(async e=>{if(e.length<3){u([]);return}try{var r;let t=await fetch("https://api-adresse.data.gouv.fr/search/?q=".concat(encodeURIComponent(e),"&limit=5")),s=await t.json();console.log("[AddressAutocomplete] R\xe9sultats API:",{query:e,features:s.features,firstResult:null===(r=s.features)||void 0===r?void 0:r[0]}),u(s.features||[])}catch(e){console.error("Erreur lors de la recherche d'adresses:",e),u([])}},[]),h=(0,a.useCallback)(e=>{let r=e.target.value;t(r,void 0),i(!0),p(-1),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{m(r)},300)},[t,m]),b=(0,a.useCallback)(e=>{let r=e.properties.label,s=[e.geometry.coordinates[1],e.geometry.coordinates[0]];console.log("[AddressAutocomplete] Suggestion s\xe9lectionn\xe9e:",{address:r,suggestion:e,geometryCoordinates:e.geometry.coordinates,coordinates:s,lambert93:{x:e.properties.x,y:e.properties.y}}),t(r,s),u([]),i(!1)},[t]),y=(0,a.useCallback)(e=>{if(c&&0!==l.length)switch(e.key){case"ArrowDown":e.preventDefault(),p(e=>e<l.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),p(e=>e>0?e-1:l.length-1);break;case"Enter":e.preventDefault(),d>=0&&b(l[d]);break;case"Escape":i(!1)}},[c,l,d,b]);return(0,a.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.jsxs)("div",{className:"relative",ref:g,children:[(0,s.jsx)("input",{type:"text",value:r,onChange:h,onKeyDown:y,onFocus:()=>i(!0),placeholder:o,className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",required:n}),c&&l.length>0&&(0,s.jsx)("div",{className:"absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg border border-gray-200",children:l.map((e,r)=>(0,s.jsx)("div",{className:"px-3 py-2 cursor-pointer hover:bg-gray-100 ".concat(r===d?"bg-gray-100":""),onClick:()=>b(e),children:(0,s.jsx)("p",{className:"text-sm text-gray-900",children:e.properties.label})},r))})]})}}}]);