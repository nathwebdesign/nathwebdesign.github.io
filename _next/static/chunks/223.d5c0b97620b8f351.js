"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{4223:(e,r,t)=>{t.r(r),t.d(r,{default:()=>o});var s=t(5155),a=t(2115);function o(e){let{value:r,onChange:t,placeholder:o,required:l=!1}=e,[n,u]=(0,a.useState)([]),[c,i]=(0,a.useState)(!1),[d,p]=(0,a.useState)(-1),f=(0,a.useRef)(null),g=(0,a.useRef)(null),h=(0,a.useCallback)(async e=>{if(e.length<3)return void u([]);try{var r;let t=await fetch("https://api-adresse.data.gouv.fr/search/?q=".concat(encodeURIComponent(e),"&limit=5")),s=await t.json();console.log("[AddressAutocomplete] R\xe9sultats API:",{query:e,features:s.features,firstResult:null==(r=s.features)?void 0:r[0]}),u(s.features||[])}catch(e){console.error("Erreur lors de la recherche d'adresses:",e),u([])}},[]),m=(0,a.useCallback)(e=>{let r=e.target.value;t(r,void 0),i(!0),p(-1),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{h(r)},300)},[t,h]),b=(0,a.useCallback)(e=>{let r=e.properties.label,s=[e.properties.y,e.properties.x];console.log("[AddressAutocomplete] Suggestion s\xe9lectionn\xe9e:",{address:r,suggestion:e,coordinates:s,x:e.properties.x,y:e.properties.y}),t(r,s),u([]),i(!1)},[t]),v=(0,a.useCallback)(e=>{if(c&&0!==n.length)switch(e.key){case"ArrowDown":e.preventDefault(),p(e=>e<n.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),p(e=>e>0?e-1:n.length-1);break;case"Enter":e.preventDefault(),d>=0&&b(n[d]);break;case"Escape":i(!1)}},[c,n,d,b]);return(0,a.useEffect)(()=>{let e=e=>{g.current&&!g.current.contains(e.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,s.jsxs)("div",{className:"relative",ref:g,children:[(0,s.jsx)("input",{type:"text",value:r,onChange:m,onKeyDown:v,onFocus:()=>i(!0),placeholder:o,className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary",required:l}),c&&n.length>0&&(0,s.jsx)("div",{className:"absolute z-10 mt-1 w-full rounded-md bg-white shadow-lg border border-gray-200",children:n.map((e,r)=>(0,s.jsx)("div",{className:"px-3 py-2 cursor-pointer hover:bg-gray-100 ".concat(r===d?"bg-gray-100":""),onClick:()=>b(e),children:(0,s.jsx)("p",{className:"text-sm text-gray-900",children:e.properties.label})},r))})]})}}}]);