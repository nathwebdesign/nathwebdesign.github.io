(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{4457:(r,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>u});var a=t(5155),o=t(2115),n=t(5752),c=t.n(n);function u(r){let{depart:e,arrivee:t,departCoords:n,arriveeCoords:u,poles:i}=r;console.log("[Map] Props re\xe7ues:",{depart:e,arrivee:t,departCoords:n,arriveeCoords:u,departCoordsType:Array.isArray(n)?"array":typeof n,arriveeCoordsType:Array.isArray(u)?"array":typeof u});let l=(0,o.useRef)(null),s=(0,o.useRef)(null),p=(0,o.useRef)([]),d=(0,o.useRef)(null);return(0,o.useRef)("map-".concat(Math.random().toString(36).substr(2,9))),(0,o.useEffect)(()=>{let r=setTimeout(()=>{if(!l.current&&d.current)try{l.current=c().map(d.current,{center:[46.603354,1.888334],zoom:6,zoomControl:!0,attributionControl:!0}),c().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xa9 OpenStreetMap contributors",maxZoom:19,minZoom:3}).addTo(l.current)}catch(r){}},100);return()=>{clearTimeout(r),l.current&&(l.current.remove(),l.current=null)}},[]),(0,o.useEffect)(()=>{if(!l.current)return;s.current&&(l.current.removeLayer(s.current),s.current=null),p.current.forEach(r=>{l.current.removeLayer(r)}),p.current=[];let r=(r,e)=>c().divIcon({html:'<div style="background-color: '.concat(r,'; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">').concat(e,"</div>"),className:"",iconSize:[30,30],iconAnchor:[15,15]}),a=[];if(console.log("[Map] V\xe9rification marker d\xe9part:",{departCoords:n,isArray:Array.isArray(n),length:null==n?void 0:n.length,condition:n&&Array.isArray(n)&&2===n.length}),n&&Array.isArray(n)&&2===n.length)try{console.log("[Map] Cr\xe9ation marker d\xe9part avec coords:",n);let t=c().marker(n,{icon:r("#0f172a","D")}).addTo(l.current);e&&t.bindPopup("D\xe9part: ".concat(e)),p.current.push(t),a.push(n)}catch(r){console.error("[Map] Erreur cr\xe9ation marker d\xe9part:",r)}if(console.log("[Map] V\xe9rification marker arriv\xe9e:",{arriveeCoords:u,isArray:Array.isArray(u),length:null==u?void 0:u.length,condition:u&&Array.isArray(u)&&2===u.length}),u&&Array.isArray(u)&&2===u.length)try{console.log("[Map] Cr\xe9ation marker arriv\xe9e avec coords:",u);let e=c().marker(u,{icon:r("#ef4444","A")}).addTo(l.current);t&&e.bindPopup("Arriv\xe9e: ".concat(t)),p.current.push(e),a.push(u)}catch(r){console.error("[Map] Erreur cr\xe9ation marker arriv\xe9e:",r)}if(n&&u&&Array.isArray(n)&&Array.isArray(u)&&2===n.length&&2===u.length)try{let r=[n,u];s.current=c().polyline(r,{color:"#0f172a",weight:4,opacity:.7,dashArray:"10, 10"}).addTo(l.current)}catch(r){console.error("[Map] Erreur lors du trac\xe9 de la route:",r)}console.log("[Map] Markers \xe0 afficher:",a),a.length>0&&l.current?requestAnimationFrame(()=>{if(l.current)try{if(1===a.length)console.log("[Map] Centrage sur un seul marker:",a[0]),l.current.setView(a[0],10);else{console.log("[Map] Ajustement des limites pour plusieurs markers");let r=c().latLngBounds(a);l.current.fitBounds(r,{padding:[50,50],maxZoom:10})}}catch(r){console.error("[Map] Erreur ajustement vue, fallback sur France:",r),l.current&&l.current.setView([46.603354,1.888334],6)}}):l.current&&(console.log("[Map] Aucun marker, affichage de la France"),requestAnimationFrame(()=>{if(l.current)try{l.current.setView([46.603354,1.888334],6)}catch(r){console.error("[Map] Erreur setView France:",r)}}))},[e,t,n,u]),(0,a.jsx)("div",{ref:d,className:"w-full h-full"})}t(8413)},8413:()=>{}}]);